<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>åŸŸåæ¯”å°å·¥å…·</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f172a;
      color: #e5e7eb;
      margin: 0;
      padding: 16px;
    }

    h1 {
      font-size: 20px;
      margin-bottom: 12px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    textarea {
      width: 100%;
      min-height: 160px;
      background: #020617;
      color: #e5e7eb;
      border: 1px solid #1e293b;
      border-radius: 10px;
      padding: 10px;
      resize: vertical;
    }

    button {
      margin-top: 12px;
      width: 100%;
      padding: 10px;
      background: #2563eb;
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background: #1d4ed8;
    }

    .result {
      margin-top: 16px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 10px;
    }

    .card {
      background: #020617;
      border: 1px solid #1e293b;
      border-radius: 12px;
      padding: 10px;
      font-size: 13px;
    }

    .card .title {
      font-weight: 600;
      margin-bottom: 4px;
      color: #60a5fa;
    }

    .badge {
      display: inline-block;
      background: #1e293b;
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 12px;
      margin-top: 4px;
      color: #a5b4fc;
    }

    @media (max-width: 700px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .copy-btn {
  background: #1e293b;
  border: 1px solid #334155;
  color: #e5e7eb;
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 12px;
  cursor: pointer;
}
.copy-btn:hover {
  background: #334155;
}

  </style>
</head>
<body>
  <h1>ğŸ” åŸŸåæ¯”å°å·¥å…·ï¼ˆè‡ªå‹•åˆä½µå­ç¶²åŸŸï¼‰</h1>

  <div class="grid">
    <div>
      <h3>A è¡¨</h3>
      <textarea id="listA" placeholder="a.b.com\nb.com\nfoo.bar.com"></textarea>
    </div>
    <div>
      <h3>B è¡¨</h3>
      <textarea id="listB" placeholder="b.com\nx.b.com\ntest.com"></textarea>
    </div>
  </div>
<button id="copyAllBtn" style="margin-top:8px;">è¤‡è£½å…¨éƒ¨äº¤é›†åŸŸåï¼ˆæ›è¡Œï¼‰</button>

  <button onclick="compareDomains()">é–‹å§‹æ¯”å°</button>

  <div id="summary" style="margin-top:12px;"></div>
  <div id="result" class="result"></div>

  <script>
    function normalizeDomain(domain) {
      domain = domain.trim().toLowerCase();
      if (!domain) return null;

      const parts = domain.split('.');
      if (parts.length < 2) return null;

      return parts.slice(-2).join('.');
    }

    function parseList(text) {
      return text
        .split('\n')
        .map(d => d.trim())
        .filter(Boolean);
    }

    function compareDomains() {
      const aRaw = parseList(document.getElementById('listA').value);
      const bRaw = parseList(document.getElementById('listB').value);

      const aMap = new Map();
      const bMap = new Map();

      aRaw.forEach(d => {
        const base = normalizeDomain(d);
        if (!base) return;
        if (!aMap.has(base)) aMap.set(base, []);
        aMap.get(base).push(d);
      });

      bRaw.forEach(d => {
        const base = normalizeDomain(d);
        if (!base) return;
        if (!bMap.has(base)) bMap.set(base, []);
        bMap.get(base).push(d);
      });

      const intersection = [];
      for (const base of aMap.keys()) {
        if (bMap.has(base)) {
          intersection.push({
            base,
            aList: aMap.get(base),
            bList: bMap.get(base)
          });
        }
      }

      renderResult(intersection, aRaw.length, bRaw.length);
    }

let lastIntersection = [];

    function renderResult(list, aCount, bCount) {
        lastIntersection = list; // å­˜èµ·ä¾†çµ¦å…¨åŸŸè¤‡è£½ç”¨
      const result = document.getElementById('result');
      const summary = document.getElementById('summary');
      result.innerHTML = '';

      summary.innerHTML = `
        ğŸ“Š A è¡¨ï¼š${aCount} ç­†ã€€
        B è¡¨ï¼š${bCount} ç­†ã€€
        äº¤é›†ï¼š${list.length} ç­†
      `;

      if (list.length === 0) {
        result.innerHTML = `<div style="opacity:.7;">æ²’æœ‰æ‰¾åˆ°å…±åŒåŸŸå</div>`;
        return;
      }

    list.forEach(item => {
      const div = document.createElement('div');
      div.className = 'card';

      div.innerHTML = `
        <div class="title">${item.base}</div>

        <div style="display:flex; gap:6px; margin-bottom:6px;">
          <button class="copy-btn" data-copy="${item.base}">è¤‡è£½ä¸»åŸŸå</button>
        </div>

        <div>ğŸ…°ï¸ A è¡¨åŸå§‹å€¼ï¼š</div>
        <div class="badge">${item.aList.join(', ')}</div>

        <div style="margin-top:6px;">ğŸ…±ï¸ B è¡¨åŸå§‹å€¼ï¼š</div>
        <div class="badge">${item.bList.join(', ')}</div>
      `;

      result.appendChild(div);
    });

    }
    document.addEventListener('click', e => {
  const btn = e.target.closest('.copy-btn');
  if (!btn) return;

  const text = btn.dataset.copy;
  navigator.clipboard.writeText(text).then(() => {
    btn.innerText = 'å·²è¤‡è£½ âœ…';
    setTimeout(() => (btn.innerText = 'è¤‡è£½ä¸»åŸŸå'), 1200);
  });
});

document.getElementById('copyAllBtn').addEventListener('click', () => {
  if (!lastIntersection.length) return;

  const text = lastIntersection.map(i => i.base).join('\n');
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copyAllBtn');
    const old = btn.innerText;
    btn.innerText = 'å·²è¤‡è£½å…¨éƒ¨ âœ…';
    setTimeout(() => (btn.innerText = old), 1200);
  });
});


  </script>
</body>
</html>
